<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>BTC/USD Price Prediction Using Linear Regression – Monewmetrics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dad4240a4cb460236f6ee018e9d2076a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.11.1.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Monewmetrics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Quant/index.html"> 
<span class="menu-text">Quantitative Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Stats/index.html"> 
<span class="menu-text">Statistics &amp; Probability</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Finance/index.html"> 
<span class="menu-text">Financial Analysis</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#disclaimer" id="toc-disclaimer" class="nav-link active" data-scroll-target="#disclaimer">DISCLAIMER!</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import Data</a></li>
  <li><a href="#data-cleaning-and-wrangling" id="toc-data-cleaning-and-wrangling" class="nav-link" data-scroll-target="#data-cleaning-and-wrangling">Data Cleaning and Wrangling</a></li>
  <li><a href="#explanatory-data-analysis" id="toc-explanatory-data-analysis" class="nav-link" data-scroll-target="#explanatory-data-analysis">Explanatory Data Analysis</a></li>
  <li><a href="#the-pearson-correlation-coefficient-and-p-value" id="toc-the-pearson-correlation-coefficient-and-p-value" class="nav-link" data-scroll-target="#the-pearson-correlation-coefficient-and-p-value">The Pearson correlation coefficient and p value</a></li>
  <li><a href="#model-development" id="toc-model-development" class="nav-link" data-scroll-target="#model-development">Model Development</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">Model Evaluation</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">BTC/USD Price Prediction Using Linear Regression</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>In this notebook I’m going to try and predict the BTC/USD close price(target/dependant variable) for the month of June 2022 using the linear regression as the chosen model, I will also use a set of relevant independent variables like moving averages, volume, etc. I’ll follow a basic data science workflow from importing data to model development and evaluation. Lastly, assuming the model passes the validation stage, I will bactest and measure its performance as a trading strategy to further gain insights on how reliable it can be before placing any trade based on the prediction made</p>
</blockquote>
<ul>
<li>toc: true</li>
<li>badges: true</li>
<li>categories:[Quantitative Research]</li>
<li>image:images/lr.png</li>
<li>use_plotly: true</li>
</ul>
<section id="disclaimer" class="level3">
<h3 class="anchored" data-anchor-id="disclaimer">DISCLAIMER!</h3>
<p><em>Before proceeding, please make sure that you note the following important information</em>:</p>
<p><em>NOT FINANCIAL ADVICE!</em></p>
<p><em>My content is intended to be used and must be used for informational and educational purposes only</em>. <em>I am not an attorney, CPA, or financial advisor, nor am I holding myself out to be, and the information contained on this blog/notebook is not a substitute for financial advice, None of the information contained here constitutes an offer (or solicitation of an offer) to buy or sell any security or financial instrument to make any investment or to participate in any particular trading strategy. Always seek advice from a professional who is aware of the facts and circumstances of your individual situation. Or, Independently research and verify any information that you find on my blog/notebook and wish to rely upon in making any investment decision or otherwise. I accept no liability whatsoever for any loss or damage you may incur</em></p>
<div id="cell-3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objs <span class="im">as</span> go</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.offline <span class="im">import</span> init_notebook_mode, iplot</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>init_notebook_mode(connected<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level3">
<h3 class="anchored" data-anchor-id="import-data">Import Data</h3>
<div id="cell-5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Downloading all relevant data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#BTC price and volume</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#you will import Gold price when you start creating the indipendant variables</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>Df <span class="op">=</span> yf.download(<span class="st">'BTC-USD'</span>, <span class="st">'2012-01-01'</span>, <span class="st">'2022-05-31'</span>, interval<span class="op">=</span> <span class="st">'1mo'</span>, auto_adjust<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Only keep close columns</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Df <span class="op">=</span> Df[[<span class="st">'Close'</span>,<span class="st">'Volume'</span>]]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with missing values</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>Df <span class="op">=</span> Df.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[*********************100%***********************]  1 of 1 completed</code></pre>
</div>
</div>
</section>
<section id="data-cleaning-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning-and-wrangling">Data Cleaning and Wrangling</h3>
<p>Before any modeling can be done, there are a few steps needed to prepare the data before feeding it to the model, at least by arranging the data set in a way it makes sense</p>
<div id="cell-8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reset date index and arrange rows in same format</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> Df.reset_index()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">'Close'</span>, <span class="st">'Volume'</span>]: </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>      df[i]  <span class="op">=</span>  df[i].astype(<span class="st">'float64'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014-10-01</td>
<td>338.321014</td>
<td>9.029944e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014-11-01</td>
<td>378.046997</td>
<td>6.597334e+08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014-12-01</td>
<td>320.192993</td>
<td>5.531023e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015-01-01</td>
<td>217.464005</td>
<td>1.098812e+09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015-02-01</td>
<td>254.263000</td>
<td>7.115187e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>2022-01-01</td>
<td>38483.125000</td>
<td>9.239790e+11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>2022-02-01</td>
<td>43193.234375</td>
<td>6.713360e+11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>2022-03-01</td>
<td>45538.675781</td>
<td>8.309438e+11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>2022-04-01</td>
<td>37714.875000</td>
<td>8.301159e+11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>2022-05-01</td>
<td>31792.310547</td>
<td>1.105689e+12</td>
</tr>
</tbody>
</table>

<p>92 rows × 3 columns</p>
</div>
</div>
</div>
<p>Because I’m working with monthly data, I’ll drop the days in the date to avoid confusion</p>
<div id="cell-10" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>date_format <span class="op">=</span> <span class="st">"%Y/%m"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Date'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.strftime(date_format)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014/10</td>
<td>338.321014</td>
<td>9.029944e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014/11</td>
<td>378.046997</td>
<td>6.597334e+08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014/12</td>
<td>320.192993</td>
<td>5.531023e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015/01</td>
<td>217.464005</td>
<td>1.098812e+09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015/02</td>
<td>254.263000</td>
<td>7.115187e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>2022/01</td>
<td>38483.125000</td>
<td>9.239790e+11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>2022/02</td>
<td>43193.234375</td>
<td>6.713360e+11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>2022/03</td>
<td>45538.675781</td>
<td>8.309438e+11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>2022/04</td>
<td>37714.875000</td>
<td>8.301159e+11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>2022/05</td>
<td>31792.310547</td>
<td>1.105689e+12</td>
</tr>
</tbody>
</table>

<p>92 rows × 3 columns</p>
</div>
</div>
</div>
<p>Bitcoin is often referred to as “digital gold” by its backers hence I’ll add the gold price and volume data as potential independent variables and I’ll explore further to see its relationship and whether or not it will be a good predictor</p>
<div id="cell-12" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import gold</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>gold <span class="op">=</span> yf.download(<span class="st">'GLD'</span>, <span class="st">'2014-10-01'</span>, <span class="st">'2022-05-31'</span>, interval<span class="op">=</span> <span class="st">'1mo'</span>, auto_adjust<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>gold <span class="op">=</span> gold[[<span class="st">'Close'</span>,<span class="st">'Volume'</span>]]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>gld <span class="op">=</span> gold.reset_index()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">'Close'</span>, <span class="st">'Volume'</span>]: </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>      gld[i]  <span class="op">=</span>  gld[i].astype(<span class="st">'float64'</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>gld</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[*********************100%***********************]  1 of 1 completed</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014-10-01</td>
<td>112.660004</td>
<td>155183900.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014-11-01</td>
<td>112.110001</td>
<td>147594200.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014-12-01</td>
<td>113.580002</td>
<td>153722200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015-01-01</td>
<td>123.449997</td>
<td>198034100.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015-02-01</td>
<td>116.160004</td>
<td>125686200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>2022-01-01</td>
<td>168.089996</td>
<td>211125100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>2022-02-01</td>
<td>178.380005</td>
<td>254601300.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>2022-03-01</td>
<td>180.649994</td>
<td>377087100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>2022-04-01</td>
<td>176.910004</td>
<td>195346400.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>2022-05-01</td>
<td>171.139999</td>
<td>179902200.0</td>
</tr>
</tbody>
</table>

<p>92 rows × 3 columns</p>
</div>
</div>
</div>
<p>The other two independent variables will be the moving averages and volume</p>
<p>moving averages are often used by technical analysts to keep track of price trends for specific securities. I’ll use the 3 and 6 month exponential moving averages but whether it’s simple, weighted, or exponential in general it doesn’t really make much of a difference (but this could be a good hypothesis to test)</p>
<p>Volume is also a well-known indicator of price movement, Trading volume is the total number of shares/units of a security traded during a given period of time.</p>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add the first two indipendant variables: 3ema, 6ema</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'ema3'</span>] <span class="op">=</span> df[<span class="st">'Close'</span>].ewm(span<span class="op">=</span><span class="dv">3</span>, adjust<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'ema6'</span>] <span class="op">=</span> df[<span class="st">'Close'</span>].ewm(span<span class="op">=</span><span class="dv">6</span>, adjust<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">ema3</th>
<th data-quarto-table-cell-role="th">ema6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014/10</td>
<td>338.321014</td>
<td>9.029944e+08</td>
<td>338.321014</td>
<td>338.321014</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014/11</td>
<td>378.046997</td>
<td>6.597334e+08</td>
<td>358.184006</td>
<td>349.671295</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014/12</td>
<td>320.192993</td>
<td>5.531023e+08</td>
<td>339.188499</td>
<td>341.248923</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015/01</td>
<td>217.464005</td>
<td>1.098812e+09</td>
<td>278.326252</td>
<td>305.881804</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015/02</td>
<td>254.263000</td>
<td>7.115187e+08</td>
<td>266.294626</td>
<td>291.133574</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>2022/01</td>
<td>38483.125000</td>
<td>9.239790e+11</td>
<td>44519.703176</td>
<td>46247.967191</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>2022/02</td>
<td>43193.234375</td>
<td>6.713360e+11</td>
<td>43856.468776</td>
<td>45375.186387</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>2022/03</td>
<td>45538.675781</td>
<td>8.309438e+11</td>
<td>44697.572278</td>
<td>45421.897642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>2022/04</td>
<td>37714.875000</td>
<td>8.301159e+11</td>
<td>41206.223639</td>
<td>43219.891173</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>2022/05</td>
<td>31792.310547</td>
<td>1.105689e+12</td>
<td>36499.267093</td>
<td>39954.868137</td>
</tr>
</tbody>
</table>

<p>92 rows × 5 columns</p>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adding the other two indipendant variables download gold price and godl volume (btc volume already there)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Gold Close'</span>] <span class="op">=</span> gld[<span class="st">'Close'</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Gold Volume'</span>] <span class="op">=</span> gld[<span class="st">'Volume'</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">ema3</th>
<th data-quarto-table-cell-role="th">ema6</th>
<th data-quarto-table-cell-role="th">Gold Close</th>
<th data-quarto-table-cell-role="th">Gold Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014/10</td>
<td>338.321014</td>
<td>9.029944e+08</td>
<td>338.321014</td>
<td>338.321014</td>
<td>112.660004</td>
<td>155183900.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014/11</td>
<td>378.046997</td>
<td>6.597334e+08</td>
<td>358.184006</td>
<td>349.671295</td>
<td>112.110001</td>
<td>147594200.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014/12</td>
<td>320.192993</td>
<td>5.531023e+08</td>
<td>339.188499</td>
<td>341.248923</td>
<td>113.580002</td>
<td>153722200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015/01</td>
<td>217.464005</td>
<td>1.098812e+09</td>
<td>278.326252</td>
<td>305.881804</td>
<td>123.449997</td>
<td>198034100.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015/02</td>
<td>254.263000</td>
<td>7.115187e+08</td>
<td>266.294626</td>
<td>291.133574</td>
<td>116.160004</td>
<td>125686200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>2022/01</td>
<td>38483.125000</td>
<td>9.239790e+11</td>
<td>44519.703176</td>
<td>46247.967191</td>
<td>168.089996</td>
<td>211125100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>2022/02</td>
<td>43193.234375</td>
<td>6.713360e+11</td>
<td>43856.468776</td>
<td>45375.186387</td>
<td>178.380005</td>
<td>254601300.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>2022/03</td>
<td>45538.675781</td>
<td>8.309438e+11</td>
<td>44697.572278</td>
<td>45421.897642</td>
<td>180.649994</td>
<td>377087100.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>2022/04</td>
<td>37714.875000</td>
<td>8.301159e+11</td>
<td>41206.223639</td>
<td>43219.891173</td>
<td>176.910004</td>
<td>195346400.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>2022/05</td>
<td>31792.310547</td>
<td>1.105689e+12</td>
<td>36499.267093</td>
<td>39954.868137</td>
<td>171.139999</td>
<td>179902200.0</td>
</tr>
</tbody>
</table>

<p>92 rows × 7 columns</p>
</div>
</div>
</div>
<p>Now i’m going to generate the dependant/target variable that i’m going to try and predict</p>
<div id="cell-17" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating the dependant variable which is next month close price and adding it to the dataframe </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Next Month Close'</span>] <span class="op">=</span> df[<span class="st">'Close'</span>].shift(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">ema3</th>
<th data-quarto-table-cell-role="th">ema6</th>
<th data-quarto-table-cell-role="th">Gold Close</th>
<th data-quarto-table-cell-role="th">Gold Volume</th>
<th data-quarto-table-cell-role="th">Next Month Close</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014/10</td>
<td>338.321014</td>
<td>9.029944e+08</td>
<td>338.321014</td>
<td>338.321014</td>
<td>112.660004</td>
<td>155183900.0</td>
<td>378.046997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014/11</td>
<td>378.046997</td>
<td>6.597334e+08</td>
<td>358.184006</td>
<td>349.671295</td>
<td>112.110001</td>
<td>147594200.0</td>
<td>320.192993</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014/12</td>
<td>320.192993</td>
<td>5.531023e+08</td>
<td>339.188499</td>
<td>341.248923</td>
<td>113.580002</td>
<td>153722200.0</td>
<td>217.464005</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015/01</td>
<td>217.464005</td>
<td>1.098812e+09</td>
<td>278.326252</td>
<td>305.881804</td>
<td>123.449997</td>
<td>198034100.0</td>
<td>254.263000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015/02</td>
<td>254.263000</td>
<td>7.115187e+08</td>
<td>266.294626</td>
<td>291.133574</td>
<td>116.160004</td>
<td>125686200.0</td>
<td>244.223999</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>2022/01</td>
<td>38483.125000</td>
<td>9.239790e+11</td>
<td>44519.703176</td>
<td>46247.967191</td>
<td>168.089996</td>
<td>211125100.0</td>
<td>43193.234375</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>2022/02</td>
<td>43193.234375</td>
<td>6.713360e+11</td>
<td>43856.468776</td>
<td>45375.186387</td>
<td>178.380005</td>
<td>254601300.0</td>
<td>45538.675781</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">89</td>
<td>2022/03</td>
<td>45538.675781</td>
<td>8.309438e+11</td>
<td>44697.572278</td>
<td>45421.897642</td>
<td>180.649994</td>
<td>377087100.0</td>
<td>37714.875000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90</td>
<td>2022/04</td>
<td>37714.875000</td>
<td>8.301159e+11</td>
<td>41206.223639</td>
<td>43219.891173</td>
<td>176.910004</td>
<td>195346400.0</td>
<td>31792.310547</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">91</td>
<td>2022/05</td>
<td>31792.310547</td>
<td>1.105689e+12</td>
<td>36499.267093</td>
<td>39954.868137</td>
<td>171.139999</td>
<td>179902200.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>92 rows × 8 columns</p>
</div>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We don't need the current close price hence i'll remove it from the dataframe</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>btc_close <span class="op">=</span> df[<span class="st">'Close'</span>] <span class="co">#But i'll save the close price just incase i need it </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Then i'll remove the previous month btc close price so that i'm left with only the relevant data that i need</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span><span class="st">'Close'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#i'll drop all NA values in the data frame</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Df <span class="op">=</span> df.dropna()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Now i should have a good clean dataframe ready for some EDA</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>Df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">ema3</th>
<th data-quarto-table-cell-role="th">ema6</th>
<th data-quarto-table-cell-role="th">Gold Close</th>
<th data-quarto-table-cell-role="th">Gold Volume</th>
<th data-quarto-table-cell-role="th">Next Month Close</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014/10</td>
<td>9.029944e+08</td>
<td>338.321014</td>
<td>338.321014</td>
<td>112.660004</td>
<td>155183900.0</td>
<td>378.046997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014/11</td>
<td>6.597334e+08</td>
<td>358.184006</td>
<td>349.671295</td>
<td>112.110001</td>
<td>147594200.0</td>
<td>320.192993</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014/12</td>
<td>5.531023e+08</td>
<td>339.188499</td>
<td>341.248923</td>
<td>113.580002</td>
<td>153722200.0</td>
<td>217.464005</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015/01</td>
<td>1.098812e+09</td>
<td>278.326252</td>
<td>305.881804</td>
<td>123.449997</td>
<td>198034100.0</td>
<td>254.263000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015/02</td>
<td>7.115187e+08</td>
<td>266.294626</td>
<td>291.133574</td>
<td>116.160004</td>
<td>125686200.0</td>
<td>244.223999</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>2021/12</td>
<td>9.570472e+11</td>
<td>50556.281353</td>
<td>49353.904068</td>
<td>170.960007</td>
<td>151214100.0</td>
<td>38483.125000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>2022/01</td>
<td>9.239790e+11</td>
<td>44519.703176</td>
<td>46247.967191</td>
<td>168.089996</td>
<td>211125100.0</td>
<td>43193.234375</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">88</td>
<td>2022/02</td>
<td>6.713360e+11</td>
<td>43856.468776</td>
<td>45375.186387</td>
<td>178.380005</td>
<td>254601300.0</td>
<td>45538.675781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>2022/03</td>
<td>8.309438e+11</td>
<td>44697.572278</td>
<td>45421.897642</td>
<td>180.649994</td>
<td>377087100.0</td>
<td>37714.875000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">90</td>
<td>2022/04</td>
<td>8.301159e+11</td>
<td>41206.223639</td>
<td>43219.891173</td>
<td>176.910004</td>
<td>195346400.0</td>
<td>31792.310547</td>
</tr>
</tbody>
</table>

<p>91 rows × 7 columns</p>
</div>
</div>
</div>
</section>
<section id="explanatory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="explanatory-data-analysis">Explanatory Data Analysis</h3>
<p>Intuitley I know that traders like to use the ema lines and volume to predict BTC price. But as I mentioned before here I get the chance to explore whether gold price and its volume can help predict BTC price.</p>
</section>
<section id="the-pearson-correlation-coefficient-and-p-value" class="level3">
<h3 class="anchored" data-anchor-id="the-pearson-correlation-coefficient-and-p-value">The Pearson correlation coefficient and p value</h3>
<section id="pearson-correlation" class="level4">
<h4 class="anchored" data-anchor-id="pearson-correlation">Pearson Correlation:</h4>
<p>Correlation between sets of data is a measure of how well they are related. The most common measure of correlation in stats is the Pearson Correlation.The full name is the Pearson Product Moment Correlation (PPMC). It shows the linear relationship between two sets of data. In simple terms, it answers the question, Can I draw a line graph to represent the data?</p>
It is a number between –1 and 1 that measures the strength and direction of the relationship between two variables, where:
<li>
<b>1</b>: Perfect positive linear correlation.
</li>
<pre><code>&lt;li&gt;&lt;b&gt;0&lt;/b&gt;: No linear correlation, the two variables most likely do not affect each other.&lt;/li&gt;
&lt;li&gt;&lt;b&gt;-1&lt;/b&gt;: Perfect negative linear correlation.&lt;/li&gt;</code></pre>
</section>
<section id="p-value" class="level4">
<h4 class="anchored" data-anchor-id="p-value">P-Value:</h4>
<p>A p-value measures the probability of obtaining the observed results, assuming that the null hypothesis is true. The lower the p-value, the greater the statistical significance of the observed difference. A p-value of 0.05 or lower is generally considered statistically significant which means that we are 95% confident that the correlation between the variables is significant.</p>
<p>By convention, when the</p>
<ul>
<li>
p-value is &lt; 0.001: we say there is strong evidence that the correlation is significant.
</li>
<li>
the p-value is &lt; 0.05: there is moderate evidence that the correlation is significant.
</li>
<li>
the p-value is &lt; 0.1: there is weak evidence that the correlation is significant.
</li>
<li>
the p-value is &gt; 0.1: there is no evidence that the correlation is significant.
</li>
</ul>
<p>Two things keeps to keep in mind when interprating the results:</p>
<ul>
<li>
The null hypothesis is that the two variables are uncorrelated .
</li>
<li>
The p value is in scientific notation, it’s decimal form is e.g 4.2e-7 = 0.00000042.
</li>
</ul>
<div id="cell-24" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#checking pearson correlation for gold price and volume</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#I will start form the second last row to avoid errors bcz of nan value </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">'Gold Close'</span>][:<span class="dv">90</span>], df[<span class="st">'Next Month Close'</span>][:<span class="dv">90</span>])</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The Pearson Correlation Coefficient is"</span>, pearson_coef, <span class="st">" with a P-value of P ="</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The Pearson Correlation Coefficient is 0.7706711768570538  with a P-value of P = 6.555477090301474e-19</code></pre>
</div>
</div>
<p>In this case,</p>
<p>The p-value is &lt; 0.001 hence, there is strong evidence that the correlation between gold price and BTC price is statistically significant, and the linear relationship is quite strong (0.77, close to 1)</p>
<div id="cell-26" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">'Gold Volume'</span>][:<span class="dv">90</span>], df[<span class="st">'Next Month Close'</span>][:<span class="dv">90</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The Pearson Correlation Coefficient is"</span>, pearson_coef, <span class="st">" with a P-value of P ="</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The Pearson Correlation Coefficient is 0.08476385450593574  with a P-value of P = 0.42700282567060693</code></pre>
</div>
</div>
<p>The p-value is &lt; 0.001 hence, there is moderate evidence that the correlation between gold volume and BTC price is statistically significant, and there is no linear relationship (0.08, almost 0)</p>
<p>Visually we can see that there is almost no linear relationship between gold volume and btc price</p>
<div id="cell-29" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make linear regression chart of btc next month price and gold price and do for volume</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    df, x<span class="op">=</span><span class="st">'Gold Volume'</span>, y<span class="op">=</span><span class="st">'Next Month Close'</span>, opacity<span class="op">=</span><span class="fl">0.65</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    trendline<span class="op">=</span><span class="st">'ols'</span>, trendline_color_override<span class="op">=</span><span class="st">'firebrick'</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template <span class="op">=</span> <span class="st">"plotly_dark"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="ff2582fc-e274-4003-841e-74bc784b0014" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ff2582fc-e274-4003-841e-74bc784b0014")) {                    Plotly.newPlot(                        "ff2582fc-e274-4003-841e-74bc784b0014",                        [{"hovertemplate":"Gold Volume=%{x}<br>Next Month Close=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","opacity":0.65,"symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[155183900.0,147594200.0,153722200.0,198034100.0,125686200.0,133483100.0,106636600.0,99097100.0,110267600.0,157498100.0,151171700.0,113791100.0,131532500.0,106869000.0,124503700.0,139712800.0,314968700.0,259670200.0,222989100.0,201083100.0,307601400.0,259546000.0,215783900.0,213473800.0,181298100.0,247890600.0,159862800.0,150545100.0,150265000.0,172556100.0,176157400.0,160072400.0,160832400.0,128516200.0,179580900.0,174234300.0,137821900.0,121999200.0,145856700.0,184868100.0,176366400.0,143350600.0,148538100.0,136939000.0,133529400.0,130595500.0,148356600.0,97355900.0,228476300.0,186729200.0,178898300.0,195173300.0,141982900.0,168879600.0,124262100.0,140574200.0,205599200.0,226367100.0,322877500.0,233678500.0,178417600.0,139229300.0,121345200.0,194652300.0,254781400.0,457459900.0,260294400.0,235361000.0,222122700.0,305156400.0,389593200.0,219862100.0,172289000.0,222246500.0,177576400.0,210951400.0,181008600.0,214111100.0,143030700.0,199082500.0,207522500.0,145195500.0,165504300.0,160613200.0,136138300.0,162163400.0,151214100.0,211125100.0,254601300.0,377087100.0,195346400.0,179902200.0],"xaxis":"x","y":[378.0469970703125,320.1929931640625,217.46400451660156,254.26300048828125,244.2239990234375,236.14500427246094,230.19000244140625,263.0719909667969,284.6499938964844,230.05599975585938,236.05999755859375,314.1659851074219,377.3210144042969,430.5669860839844,368.7669982910156,437.6969909667969,416.72900390625,448.3179931640625,531.385986328125,673.3369750976562,624.6810302734375,575.4719848632812,609.7349853515625,700.9719848632812,745.6909790039062,963.7429809570312,970.4030151367188,1179.969970703125,1071.7900390625,1347.8900146484375,2286.409912109375,2480.840087890625,2875.340087890625,4703.39013671875,4338.7099609375,6468.39990234375,10233.599609375,14156.400390625,10221.099609375,10397.900390625,6973.52978515625,9240.5498046875,7494.169921875,6404.0,7780.43994140625,7037.580078125,6625.56005859375,6317.60986328125,4017.2685546875,3742.700439453125,3457.792724609375,3854.785400390625,4105.404296875,5350.7265625,8574.501953125,10817.1552734375,10085.6279296875,9630.6640625,8293.8681640625,9199.5849609375,7569.6298828125,7193.59912109375,9350.529296875,8599.5087890625,6438.64453125,8658.5537109375,9461.05859375,9137.9931640625,11323.466796875,11680.8203125,10784.4912109375,13780.9951171875,19625.8359375,29001.720703125,33114.359375,45137.76953125,58918.83203125,57750.17578125,37332.85546875,35040.8359375,41626.1953125,47166.6875,43790.89453125,61318.95703125,57005.42578125,46306.4453125,38483.125,43193.234375,45538.67578125,37714.875,31792.310546875,null],"yaxis":"y","type":"scatter"},{"hovertemplate":"<b>OLS trendline</b><br>Next Month Close = 2.21725e-05 * Gold Volume + 8479.34<br>R<sup>2</sup>=0.007398<br><br>Gold Volume=%{x}<br>Next Month Close=%{y} <b>(trend)</b><extra></extra>","legendgroup":"","line":{"color":"firebrick"},"marker":{"color":"#636efa","symbol":"circle"},"mode":"lines","name":"","showlegend":false,"x":[97355900.0,99097100.0,106636600.0,106869000.0,110267600.0,113791100.0,121345200.0,121999200.0,124262100.0,124503700.0,125686200.0,128516200.0,130595500.0,131532500.0,133483100.0,133529400.0,136138300.0,136939000.0,137821900.0,139229300.0,139712800.0,140574200.0,141982900.0,143030700.0,143350600.0,145195500.0,145856700.0,147594200.0,148356600.0,148538100.0,150265000.0,150545100.0,151171700.0,151214100.0,153722200.0,155183900.0,157498100.0,159862800.0,160072400.0,160613200.0,160832400.0,162163400.0,165504300.0,168879600.0,172289000.0,172556100.0,174234300.0,176157400.0,176366400.0,177576400.0,178417600.0,178898300.0,179580900.0,181008600.0,181298100.0,184868100.0,186729200.0,194652300.0,195173300.0,195346400.0,198034100.0,199082500.0,201083100.0,205599200.0,207522500.0,210951400.0,211125100.0,213473800.0,214111100.0,215783900.0,219862100.0,222122700.0,222246500.0,222989100.0,226367100.0,228476300.0,233678500.0,235361000.0,247890600.0,254601300.0,254781400.0,259546000.0,259670200.0,260294400.0,305156400.0,307601400.0,314968700.0,322877500.0,377087100.0,389593200.0,457459900.0],"xaxis":"x","y":[10637.962009194842,10676.568809003677,10843.738558118486,10848.891452832231,10924.246994889607,11002.371885267754,11169.865353241516,11184.366184320645,11234.540390205902,11239.897272145838,11266.11628246857,11328.86452704645,11374.96785741775,11395.743512954667,11438.993239411771,11440.019827300095,11497.865726692047,11515.619267127917,11535.19538908474,11566.401000186826,11577.121415824071,11596.220828502297,11627.455263886346,11650.687635147371,11657.780625762376,11698.686716370761,11713.347189626906,11751.871951094772,11768.776283839004,11772.80059705133,11811.090329758586,11817.300853895076,11831.194157800554,11832.134272842992,11887.745181756694,11920.154760943791,11971.4664173403,12023.897786228395,12028.545147381585,12040.536048677597,12045.39626606681,12074.907896290539,12148.984083679314,12223.82300591384,12299.418011236743,12305.340292553617,12342.550223313545,12385.19020534454,12389.824262982977,12416.653017731822,12435.304545413415,12445.962877981821,12461.097843264104,12492.753556615282,12499.172502482877,12578.328415254266,12619.59370076094,12795.26883030687,12806.820715616082,12810.658779621888,12870.251873951205,12893.49754872698,12937.855901413377,13037.989239695411,13080.633656231323,13156.661025783651,13160.512393304209,13212.58900179893,13226.719551717473,13263.809750844637,13354.23374061054,13404.356949689249,13407.101908232975,13423.567224990406,13498.466013041314,13545.232301897733,13660.578209298099,13697.883481913745,13975.696345964268,14124.489506702346,14128.482778380254,14234.125989021864,14236.879816575423,14250.719906421893,15245.423704391065,15299.635527003402,15462.987167384532,15638.345229828887,16840.308918616494,17117.600728339246,18622.376802647894],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Gold Volume"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Next Month Close"}},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('ff2582fc-e274-4003-841e-74bc784b0014');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>So we now know that we can use gold price but not its volume, it would have destroyed value and it wouldn’t have added anything to the model if anything it would have probably ruined our prediction</p>
<div id="cell-31" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping gold volume</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span><span class="st">'Gold Volume'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">ema3</th>
<th data-quarto-table-cell-role="th">ema6</th>
<th data-quarto-table-cell-role="th">Gold Close</th>
<th data-quarto-table-cell-role="th">Next Month Close</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014/10</td>
<td>9.029944e+08</td>
<td>338.321014</td>
<td>338.321014</td>
<td>112.660004</td>
<td>378.046997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014/11</td>
<td>6.597334e+08</td>
<td>358.184006</td>
<td>349.671295</td>
<td>112.110001</td>
<td>320.192993</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014/12</td>
<td>5.531023e+08</td>
<td>339.188499</td>
<td>341.248923</td>
<td>113.580002</td>
<td>217.464005</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015/01</td>
<td>1.098812e+09</td>
<td>278.326252</td>
<td>305.881804</td>
<td>123.449997</td>
<td>254.263000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015/02</td>
<td>7.115187e+08</td>
<td>266.294626</td>
<td>291.133574</td>
<td>116.160004</td>
<td>244.223999</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>What about the the other indipendant variables?</p>
<div id="cell-33" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'EMA 3'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">'ema3'</span>][:<span class="dv">90</span>], df[<span class="st">'Next Month Close'</span>][:<span class="dv">90</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The Pearson Correlation Coefficient is"</span>, pearson_coef, <span class="st">" with a P-value of P ="</span>, p_value)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">EMA 6'</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">'ema6'</span>][:<span class="dv">90</span>], df[<span class="st">'Next Month Close'</span>][:<span class="dv">90</span>])</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The Pearson Correlation Coefficient is"</span>, pearson_coef, <span class="st">" with a P-value of P ="</span>, p_value)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Volume'</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">'Volume'</span>][:<span class="dv">90</span>], df[<span class="st">'Next Month Close'</span>][:<span class="dv">90</span>])</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The Pearson Correlation Coefficient is"</span>, pearson_coef, <span class="st">" with a P-value of P ="</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>EMA 3
The Pearson Correlation Coefficient is 0.9518278081533298  with a P-value of P = 5.913915911148407e-47

EMA 6
The Pearson Correlation Coefficient is 0.9357719658423489  with a P-value of P = 1.3124438502636034e-41

Volume
The Pearson Correlation Coefficient is 0.7995337431531997  with a P-value of P = 3.465784507142274e-21</code></pre>
</div>
</div>
<p>The other indipendant variables are all statistically significant, and their linear relationship are very strong with p-values of &lt; 0.001</p>
</section>
<section id="note" class="level4">
<h4 class="anchored" data-anchor-id="note">NOTE:</h4>
<p>Causation is the relationship between cause and effect between two variables.</p>
<p>It is important to know the difference between correlation and causation. Correlation does not imply causation. Determining correlation is much simpler than determining causation as causation may require independent experimentation.</p>
</section>
</section>
<section id="model-development" class="level3">
<h3 class="anchored" data-anchor-id="model-development">Model Development</h3>
<p>Before we continue let’s clarify the objective again: I’m using the 3 and 6 month ema, BTC previous month volume, and Gold close price of the preceding month to predict what BTC close price of the impending month</p>
<div id="cell-38" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the indipendant variables</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> Df[[<span class="st">'ema3'</span>,<span class="st">'ema6'</span>,<span class="st">'Volume'</span>,<span class="st">'Gold Close'</span>]]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dependent variable</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> Df[<span class="st">'Next Month Close'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I am going to spilt the data, 80% of the data will be used to train the model and 20% will be used to test the prediction made from that 80%</p>
<div id="cell-40" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into train and test dataset</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fl">.8</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="bu">int</span>(t<span class="op">*</span><span class="bu">len</span>(Df))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Train dataset</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>x_train <span class="op">=</span> x[:t]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> y[:t]</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Test dataset</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>x_test <span class="op">=</span> x[t:]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> y[t:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-41" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print the lengths</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"number of test samples :"</span>, y_test.shape[<span class="dv">0</span>])</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"number of training samples:"</span>,y_train.shape[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of test samples : 19
number of training samples: 72</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the regression</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> linear_model.LinearRegression()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>reg.fit(x_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>LinearRegression()</code></pre>
</div>
</div>
<p>The constant came back negative which is confusing but i’ll get back to this later</p>
<div id="cell-44" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Intercept value</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>reg.intercept_ </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>-1262.8899087871669</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make coefficient table</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>coeff_df <span class="op">=</span> pd.DataFrame(reg.coef_.T, x.columns, columns<span class="op">=</span>[<span class="st">'Coefficient'</span>]) </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>coeff_df </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ema3</td>
<td>1.777304e+00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ema6</td>
<td>-9.488261e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Volume</td>
<td>9.555041e-10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Gold Close</td>
<td>1.521999e+01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The Multiple linear regression formula:</p>
<section id="y-β_0-β_1-x_1-β_2-x_2-β_3-x_3-β_4-x_4" class="level4">
<h4 class="anchored" data-anchor-id="y-β_0-β_1-x_1-β_2-x_2-β_3-x_3-β_4-x_4"><span class="math display">\[ y = β_{0} \;+ \;β_{1} * \;X_{1} + \;β_{2} * \;X_{2} + \;β_{3} * \;X_{3} + \;β_{4} * \;X_{4}\]</span></h4>
<div id="cell-47" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Linear Regression model"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BTC Price (y) = </span><span class="sc">%.2f</span><span class="st"> (constant) + </span><span class="sc">%.2f</span><span class="st"> * EM3 (x1) + </span><span class="sc">%.2f</span><span class="st"> * EMA6 (x2) + </span><span class="sc">%.4f</span><span class="st"> * Volume (x3) + </span><span class="sc">%.2f</span><span class="st"> * Gold Close (x4)"</span> <span class="op">%</span> (reg.intercept_,reg.coef_[<span class="dv">0</span>], reg.coef_[<span class="dv">1</span>],reg.coef_[<span class="dv">2</span>],reg.coef_[<span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression model
BTC Price (y) = -1262.89 (constant) + 1.78 * EM3 (x1) + -0.95 * EMA6 (x2) + 0.0000 * Volume (x3) + 15.22 * Gold Close (x4)</code></pre>
</div>
</div>
</section>
</section>
<section id="model-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h3>
<p>In this step, I will evaluate the model’s accuracy but before that happens I’m going to make the predictions first</p>
<div id="cell-50" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make prediction of test data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>predicted_price <span class="op">=</span> reg.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The R square is 0.05 which means the model’s predicitive power is poor in fact it is worse than what I expected it predicts little to nothing of the target variable</p>
<div id="cell-52" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check r2 and MSE's of testing data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>test_r2_score <span class="op">=</span> r2_score(y_test,predicted_price)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test R-square is: '</span>, test_r2_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test R-square is:  0.053315838215583056</code></pre>
</div>
</div>
<p>I will also look at other evaluation methods</p>
<div id="cell-54" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Test r2</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>test_r2_score <span class="op">=</span> r2_score(y_test,predicted_price)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test R-square is: '</span>, test_r2_score)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>test_mse <span class="op">=</span> mean_squared_error(y_test, predicted_price)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test mean square error of target variable and predicted value is: '</span>, test_mse)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>test_mae <span class="op">=</span> mean_absolute_error(y_test, predicted_price)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test mean absolute error of target variable and predicted value is: '</span>, test_mae)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>test_rmse<span class="op">=</span>np.sqrt(test_mse)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The test root mean square error of target variable and predicted value is: '</span>, test_rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The test R-square is:  0.053315838215583056
The test mean square error of target variable and predicted value is:  107191024.05803142
The test mean absolute error of target variable and predicted value is:  8821.373009960726
The test root mean square error of target variable and predicted value is:  10353.309811747711</code></pre>
</div>
</div>
<p>Mean Square Error (MSE) is the average difference of actual values and predicted values There is no correct value for MSE. Simply put, the lower the value the better, and 0 means the model is perfect.</p>
<p>Mean Absolute Error (MAE) is the sum of the absolute difference between actual and predicted values in this case the average difference is $8821</p>
<p>I’m going to evaluate further and try to see what other insights I can gather from the predicted price I’ll start by creating a data frame and add the predicted price and actual price so that I can plot the prices side by side</p>
<div id="cell-57" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>btc <span class="op">=</span> pd.DataFrame()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#btc['Close Previous Month'] = btc_close[t:]</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>btc[<span class="st">'Date'</span>] <span class="op">=</span> Df[<span class="st">'Date'</span>][t:]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>btc[<span class="st">'Predicted Close'</span>] <span class="op">=</span> predicted_price</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>btc[<span class="st">'Actual Close'</span>] <span class="op">=</span> btc_close[t:].shift(<span class="op">-</span><span class="dv">1</span>)<span class="co">#btc['Close Previous Month'].shift(-1)</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>btc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Predicted Close</th>
<th data-quarto-table-cell-role="th">Actual Close</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">72</td>
<td>2020/10</td>
<td>13607.631908</td>
<td>19625.835938</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>2020/11</td>
<td>17737.624104</td>
<td>29001.720703</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>2020/12</td>
<td>25451.933856</td>
<td>33114.359375</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>2021/01</td>
<td>31623.812022</td>
<td>45137.769531</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>2021/02</td>
<td>40797.895059</td>
<td>58918.832031</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77</td>
<td>2021/03</td>
<td>52011.667637</td>
<td>57750.175781</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">78</td>
<td>2021/04</td>
<td>55687.583652</td>
<td>37332.855469</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79</td>
<td>2021/05</td>
<td>43935.783612</td>
<td>35040.835938</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>2021/06</td>
<td>35882.237824</td>
<td>41626.195312</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>2021/07</td>
<td>36483.673993</td>
<td>47166.687500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>2021/08</td>
<td>40423.918840</td>
<td>43790.894531</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>2021/09</td>
<td>39815.250546</td>
<td>61318.957031</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>2021/10</td>
<td>50330.042450</td>
<td>57005.425781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">85</td>
<td>2021/11</td>
<td>51684.668062</td>
<td>46306.445312</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>2021/12</td>
<td>45279.181353</td>
<td>38483.125000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>2022/01</td>
<td>37422.063673</td>
<td>43193.234375</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">88</td>
<td>2022/02</td>
<td>36986.624235</td>
<td>45538.675781</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>2022/03</td>
<td>38624.254997</td>
<td>37714.875000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">90</td>
<td>2022/04</td>
<td>34450.675253</td>
<td>31792.310547</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-58" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a chart of predicted next month close VS actual next month close</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(btc, x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span>btc.columns,              </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'Predicted Close Vs Actual Close'</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    rangeslider_visible<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    rangeselector<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        buttons<span class="op">=</span><span class="bu">list</span>([</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(count<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">"1m"</span>, step<span class="op">=</span><span class="st">"month"</span>, stepmode<span class="op">=</span><span class="st">"backward"</span>),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(count<span class="op">=</span><span class="dv">6</span>, label<span class="op">=</span><span class="st">"6m"</span>, step<span class="op">=</span><span class="st">"month"</span>, stepmode<span class="op">=</span><span class="st">"backward"</span>),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(count<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">"YTD"</span>, step<span class="op">=</span><span class="st">"year"</span>, stepmode<span class="op">=</span><span class="st">"todate"</span>),</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(count<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="st">"1y"</span>, step<span class="op">=</span><span class="st">"year"</span>, stepmode<span class="op">=</span><span class="st">"backward"</span>),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(step<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>fig.update_layout(template <span class="op">=</span> <span class="st">"plotly_dark"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="c75ac71f-469d-4dbf-b874-45e94023e2b5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c75ac71f-469d-4dbf-b874-45e94023e2b5")) {                    Plotly.newPlot(                        "c75ac71f-469d-4dbf-b874-45e94023e2b5",                        [{"hovertemplate":"variable=Predicted Close<br>Date=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Predicted Close","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Predicted Close","orientation":"v","showlegend":true,"x":["2020/10","2020/11","2020/12","2021/01","2021/02","2021/03","2021/04","2021/05","2021/06","2021/07","2021/08","2021/09","2021/10","2021/11","2021/12","2022/01","2022/02","2022/03","2022/04"],"xaxis":"x","y":[13607.631908067066,17737.624103572693,25451.933855554722,31623.812022417726,40797.89505897185,52011.66763684453,55687.58365186467,43935.783612333355,35882.23782412857,36483.673992760276,40423.918840004764,39815.25054574614,50330.04245025116,51684.668061937395,45279.1813533945,37422.06367279034,36986.62423479006,38624.25499655667,34450.67525281707],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=Actual Close<br>Date=%{x}<br>value=%{y}<extra></extra>","legendgroup":"Actual Close","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"Actual Close","orientation":"v","showlegend":true,"x":["2020/10","2020/11","2020/12","2021/01","2021/02","2021/03","2021/04","2021/05","2021/06","2021/07","2021/08","2021/09","2021/10","2021/11","2021/12","2022/01","2022/02","2022/03","2022/04"],"xaxis":"x","y":[19625.8359375,29001.720703125,33114.359375,45137.76953125,58918.83203125,57750.17578125,37332.85546875,35040.8359375,41626.1953125,47166.6875,43790.89453125,61318.95703125,57005.42578125,46306.4453125,38483.125,43193.234375,45538.67578125,37714.875,31792.310546875],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#f2f5fa"},"error_y":{"color":"#f2f5fa"},"marker":{"line":{"color":"rgb(17,17,17)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"baxis":{"endlinecolor":"#A2B1C6","gridcolor":"#506784","linecolor":"#506784","minorgridcolor":"#506784","startlinecolor":"#A2B1C6"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"line":{"color":"#283442"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"marker":{"line":{"color":"#283442"}},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#506784"},"line":{"color":"rgb(17,17,17)"}},"header":{"fill":{"color":"#2a3f5f"},"line":{"color":"rgb(17,17,17)"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#f2f5fa","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#f2f5fa"},"geo":{"bgcolor":"rgb(17,17,17)","lakecolor":"rgb(17,17,17)","landcolor":"rgb(17,17,17)","showlakes":true,"showland":true,"subunitcolor":"#506784"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"dark"},"paper_bgcolor":"rgb(17,17,17)","plot_bgcolor":"rgb(17,17,17)","polar":{"angularaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","radialaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"yaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"},"zaxis":{"backgroundcolor":"rgb(17,17,17)","gridcolor":"#506784","gridwidth":2,"linecolor":"#506784","showbackground":true,"ticks":"","zerolinecolor":"#C8D4E3"}},"shapedefaults":{"line":{"color":"#f2f5fa"}},"sliderdefaults":{"bgcolor":"#C8D4E3","bordercolor":"rgb(17,17,17)","borderwidth":1,"tickwidth":0},"ternary":{"aaxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"baxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""},"bgcolor":"rgb(17,17,17)","caxis":{"gridcolor":"#506784","linecolor":"#506784","ticks":""}},"title":{"x":0.05},"updatemenudefaults":{"bgcolor":"#506784","borderwidth":0},"xaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#283442","linecolor":"#506784","ticks":"","title":{"standoff":15},"zerolinecolor":"#283442","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Date"},"rangeslider":{"visible":true},"rangeselector":{"buttons":[{"count":1,"label":"1m","step":"month","stepmode":"backward"},{"count":6,"label":"6m","step":"month","stepmode":"backward"},{"count":1,"label":"YTD","step":"year","stepmode":"todate"},{"count":1,"label":"1y","step":"year","stepmode":"backward"},{"step":"all"}]}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"title":{"text":"Predicted Close Vs Actual Close"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c75ac71f-469d-4dbf-b874-45e94023e2b5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>We have already seen the mean of these residuals (mean squared error), now I’ll look at the residuals of each month in absolute and in % to see how far off are the predictions for each month (Remember, the residual is the difference between the observed value and the estimated value)</p>
<div id="cell-60" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>btc[<span class="st">'Residual'</span>] <span class="op">=</span> btc_close[t:] <span class="op">-</span> btc[<span class="st">'Actual Close'</span>] <span class="co">#The difference in absolute $ terms</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>btc[<span class="st">'Residual in %'</span>] <span class="op">=</span> np.absolute(btc[<span class="st">'Residual'</span>]<span class="op">/</span>btc[<span class="st">'Actual Close'</span>]<span class="op">*</span><span class="dv">100</span>) <span class="co">#The difference in % </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>btc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Predicted Close</th>
<th data-quarto-table-cell-role="th">Actual Close</th>
<th data-quarto-table-cell-role="th">Residual</th>
<th data-quarto-table-cell-role="th">Residual in %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">72</td>
<td>2020/10</td>
<td>13607.631908</td>
<td>19625.835938</td>
<td>-5844.840820</td>
<td>29.781360</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73</td>
<td>2020/11</td>
<td>17737.624104</td>
<td>29001.720703</td>
<td>-9375.884766</td>
<td>32.328719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">74</td>
<td>2020/12</td>
<td>25451.933856</td>
<td>33114.359375</td>
<td>-4112.638672</td>
<td>12.419502</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>2021/01</td>
<td>31623.812022</td>
<td>45137.769531</td>
<td>-12023.410156</td>
<td>26.637138</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>2021/02</td>
<td>40797.895059</td>
<td>58918.832031</td>
<td>-13781.062500</td>
<td>23.389911</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77</td>
<td>2021/03</td>
<td>52011.667637</td>
<td>57750.175781</td>
<td>1168.656250</td>
<td>2.023641</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">78</td>
<td>2021/04</td>
<td>55687.583652</td>
<td>37332.855469</td>
<td>20417.320312</td>
<td>54.689951</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79</td>
<td>2021/05</td>
<td>43935.783612</td>
<td>35040.835938</td>
<td>2292.019531</td>
<td>6.540996</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>2021/06</td>
<td>35882.237824</td>
<td>41626.195312</td>
<td>-6585.359375</td>
<td>15.820229</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>2021/07</td>
<td>36483.673993</td>
<td>47166.687500</td>
<td>-5540.492188</td>
<td>11.746621</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>2021/08</td>
<td>40423.918840</td>
<td>43790.894531</td>
<td>3375.792969</td>
<td>7.708892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>2021/09</td>
<td>39815.250546</td>
<td>61318.957031</td>
<td>-17528.062500</td>
<td>28.585063</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>2021/10</td>
<td>50330.042450</td>
<td>57005.425781</td>
<td>4313.531250</td>
<td>7.566878</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">85</td>
<td>2021/11</td>
<td>51684.668062</td>
<td>46306.445312</td>
<td>10698.980469</td>
<td>23.104733</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>2021/12</td>
<td>45279.181353</td>
<td>38483.125000</td>
<td>7823.320312</td>
<td>20.329223</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>2022/01</td>
<td>37422.063673</td>
<td>43193.234375</td>
<td>-4710.109375</td>
<td>10.904739</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">88</td>
<td>2022/02</td>
<td>36986.624235</td>
<td>45538.675781</td>
<td>-2345.441406</td>
<td>5.150438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89</td>
<td>2022/03</td>
<td>38624.254997</td>
<td>37714.875000</td>
<td>7823.800781</td>
<td>20.744602</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">90</td>
<td>2022/04</td>
<td>34450.675253</td>
<td>31792.310547</td>
<td>5922.564453</td>
<td>18.628921</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As you can see from the residual, the difference is pretty large but this is due to BTC being very volatile hence anything between 7-10% difference (this is subjective based on my observations from BTC trading) could be good but to expect a residual of less than 5% consistently would be very unlikely from an asset class this volatile</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>If the model had been at least 50-60% accurate (have an R square of 0.50-0.60), I would have proceeded with backtesting and then take the model live by predicting the close price of this month (June 2022)</p>
<p>The linear regression is not a good model to use when predicting BTC/USD prices, maybe it would’ve been more efficient in predicting the returns instead. There were many red flags and based on the R square alone I would never take this model live and risk real money on it</p>
<p>The MSE was way too high and very far from 0 since MSE is a measure of how close a fitted line is to data points</p>
<p>Another red flag was the constant being negative, This means when the independent variables are 0 the mean price of BTC will be -1262. A negative constant doesn’t mean the regression made a mistake but rather it’s the data being modeled, realistically any security price can go to 0 but no security price can fall below 0 and turn negative, The your position value of that asset can turn negative but not the actual asset price. which is also why I think predicting returns instead of price would have been more accurate and much more realistic</p>
<p>This is also a good example to showcase how a machine learning model is only as useful as the features selected and in-order to select the right features depends on the knowledge one has of that data set!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mjabubakar22\.github\.io\/MJ-Monewmetrics\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>